<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏±‡∏ö‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡∏ú‡∏π‡πâ‡∏≠‡∏≥‡∏ô‡∏ß‡∏¢‡∏Å‡∏≤‡∏£ ‚Äî V3</title>
  <style>
    body{
      font-family:"Prompt",system-ui,-apple-system,Segoe UI,Roboto;
      background:#f6f7f9;
      margin:0
    }
    header{
      background:#0d6efd;
      color:#fff;
      padding:14px 18px;
      font-size:18px
    }
    main{
      max-width:980px;
      margin:20px auto;
      background:#fff;
      padding:22px;
      border-radius:14px;
      box-shadow:0 8px 24px rgba(0,0,0,.06)
    }
    .row{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:14px
    }
    label{
      font-size:14px;
      color:#333
    }
    input,select,textarea,button{
      width:100%;
      padding:10px;
      border:1px solid #dcdfe4;
      border-radius:10px;
      font-size:14px;
      transition:all .25s ease-in-out;
    }
    select:hover, select:focus{
      border-color:#0d6efd;
      box-shadow:0 0 6px rgba(13,110,253,.3);
    }
    button{
      background:#0d6efd;
      color:#fff;
      border:none;
      cursor:pointer
    }
    button:hover{
      opacity:.95
    }
    table{
      width:100%;
      border-collapse:collapse;
      margin-top:18px
    }
    th,td{
      border:1px solid #e9ecef;
      padding:10px;
      text-align:left;
      font-size:14px
    }
    th{
      background:#f3f4f6
    }
  </style>
</head>
<body>
  <header>üìë ‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏±‡∏ö‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡∏ú‡∏π‡πâ‡∏≠‡∏≥‡∏ô‡∏ß‡∏¢‡∏Å‡∏≤‡∏£ ‚Äî Version 3</header>

  <main>
    <form id="docForm">
      <div class="row">
        <div>
          <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö</label>
          <input type="date" id="date" />
        </div>

        <div>
          <label>‡πÄ‡∏ß‡∏•‡∏≤</label>
          <input type="time" id="time" />
        </div>
      </div>

      <div class="row">
        <div>
          <label>‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á</label>
          <input type="text" id="subject" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏Ç‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥..." />
        </div>

        <div>
          <label>‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡πà‡∏ß‡∏ô</label>
          <select id="urgency">
            <option value="‡∏õ‡∏Å‡∏ï‡∏¥">‡∏õ‡∏Å‡∏ï‡∏¥</option>
            <option value="‡∏î‡πà‡∏ß‡∏ô">‡∏î‡πà‡∏ß‡∏ô</option>
            <option value="‡∏î‡πà‡∏ß‡∏ô‡∏°‡∏≤‡∏Å">‡∏î‡πà‡∏ß‡∏ô‡∏°‡∏≤‡∏Å</option>
            <option value="‡∏î‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î">‡∏î‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</option>
          </select>
        </div>
      </div>

      <div class="row">
        <div>
          <label>‡∏ú‡∏π‡πâ‡πÄ‡∏™‡∏ô‡∏≠</label>
          <input type="text" id="from" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô/‡∏ú‡∏π‡πâ‡πÄ‡∏™‡∏ô‡∏≠" />
        </div>

        <div>
          <label>‡∏ä‡∏±‡πâ‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏±‡∏ö</label>
          <select id="secret">
            <option value="‡∏•‡∏±‡∏ö">‡∏•‡∏±‡∏ö</option>
            <option value="‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏Å">‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏Å</option>
            <option value="‡∏•‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î">‡∏•‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</option>
          </select>
        </div>
      </div>

      <div class="row">
        <div>
          <label>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</label>
          <input type="text" id="note" placeholder="‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)" />
        </div>
      </div>

      <div style="margin-top:12px">
        <button type="button" id="saveBtn">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
      </div>
    </form>

    <!-- ===================== TABLE ===================== -->
    <table id="docTable">
      <thead>
        <tr>
          <th>‡πÄ‡∏•‡∏Ç‡∏£‡∏±‡∏ö</th>
          <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö</th>
          <th>‡πÄ‡∏ß‡∏•‡∏≤</th>
          <th>‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á</th>
          <th>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡πà‡∏ß‡∏ô</th>
          <th>‡∏ä‡∏±‡πâ‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏±‡∏ö</th>
          <th>‡∏ú‡∏π‡πâ‡πÄ‡∏™‡∏ô‡∏≠</th>
          <th>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</th>
          <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
          <th>‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</th>
          <th>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏°‡∏∑‡πà‡∏≠</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <!-- ‡∏ä‡πà‡∏≠‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ -->
    <div style="margin-top:16px">
      <input
        type="text"
        id="searchBox"
        placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤: ‡πÄ‡∏•‡∏Ç‡∏£‡∏±‡∏ö / ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á / ‡∏ú‡∏π‡πâ‡πÄ‡∏™‡∏ô‡∏≠"
        style="width:100%;padding:10px;border:1px solid #dcdfe4;border-radius:10px;font-size:14px"
      />
    </div>

    <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏Å‡∏£‡∏≠‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ -->
    <div style="margin-top:16px; display:flex; gap:10px; flex-wrap:wrap;">
      <button id="filterAll">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
      <button id="filterWait">‡∏£‡∏≠‡πÄ‡∏™‡∏ô‡∏≠</button>
      <button id="filterPending">‡∏£‡∏≠‡πÄ‡∏ã‡πá‡∏ô</button>
      <button id="filterSigned">‡πÄ‡∏ã‡πá‡∏ô‡πÅ‡∏•‡πâ‡∏ß</button>
      <button id="filterReturn">‡∏™‡πà‡∏á‡∏Ñ‡∏∑‡∏ô‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
    </div>

    <!-- Export Excel -->
    <button id="exportBtn" style="margin-top:16px;">üìÅ Export Excel</button>

    <!-- Dashboard -->
    <div id="dashboard" style="margin-top:20px">
      <h3>Dashboard (‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô/‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô)</h3>
      <p id="dailyCount">‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô: -</p>
      <p id="monthlyCount">‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô: -</p>
    </div>
    <!-- ===================== LOGIC (PART 2) ===================== -->
    <script type="module">
      /* 1) ‡πÉ‡∏™‡πà Firebase Config ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì */
      const firebaseConfig = {
        apiKey: "PASTE_API_KEY_HERE",
        authDomain: "PASTE_AUTH_DOMAIN_HERE",
        projectId: "PASTE_PROJECT_ID_HERE",
        storageBucket: "PASTE_STORAGE_BUCKET_HERE",
        appId: "PASTE_APP_ID_HERE",
      };

      /* 2) SDK Imports */
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-app.js";
      import {
        getFirestore, collection, addDoc, serverTimestamp,
        query, orderBy, onSnapshot, updateDoc, doc,
        getDocs, where, Timestamp, limit
      } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-firestore.js";
      import * as XLSX from "https://cdn.sheetjs.com/xlsx-latest/package/xlsx.mjs";

      /* 3) Init */
      const app = initializeApp(firebaseConfig);
      const db  = getFirestore(app);
      const docsCol = collection(db, "incoming_docs");

      /* 4) DOM Refs */
      const tbody   = document.querySelector("#docTable tbody");
      const btnSave = document.getElementById("saveBtn");
      const searchBox = document.getElementById("searchBox");
      const exportBtn = document.getElementById("exportBtn");
      const dailyEl   = document.getElementById("dailyCount");
      const monthlyEl = document.getElementById("monthlyCount");

      /* 5) Utilities */
      const fmtDateTimeTH = (d) =>
        new Intl.DateTimeFormat("th-TH", { dateStyle: "short", timeStyle: "short" }).format(d);

      const statusIcon = (s) => {
        switch (s) {
          case "‡∏£‡∏≠‡πÄ‡∏™‡∏ô‡∏≠": return "üü°";
          case "‡∏£‡∏≠‡πÄ‡∏ã‡πá‡∏ô": return "üîµ";
          case "‡πÄ‡∏ã‡πá‡∏ô‡πÅ‡∏•‡πâ‡∏ß": return "üü¢";
          case "‡∏™‡πà‡∏á‡∏Ñ‡∏∑‡∏ô‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç": return "üî¥";
          default: return "‚ö™";
        }
      };

      /* 6) ‡πÄ‡∏•‡∏Ç‡∏£‡∏±‡∏ö‡∏£‡∏±‡∏ô‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ (‡∏Å‡∏•‡∏≤‡∏á) */
      async function generateRefNo() {
        const yearTH = new Date().getFullYear() + 543;
        const qLast = query(docsCol, orderBy("refno", "desc"), limit(1));
        const snap  = await getDocs(qLast);

        let next = 1;
        if (!snap.empty) {
          const last = snap.docs[0].data().refno || "";
          const [seqStr, y] = last.split("/");
          if (parseInt(y) === yearTH) next = (parseInt(seqStr) || 0) + 1;
        }
        return `${String(next).padStart(3, "0")}/${yearTH}`;
      }

      /* 7) ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• */
      btnSave.addEventListener("click", async () => {
        const date    = document.getElementById("date").value;
        const time    = document.getElementById("time").value;
        const subject = document.getElementById("subject").value.trim();
        const urgency = document.getElementById("urgency").value;
        const from    = document.getElementById("from").value.trim();
        const note    = document.getElementById("note").value.trim();
        const secret  = document.getElementById("secret").value;

        if (!date || !time || !subject || !from) {
          alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà/‡πÄ‡∏ß‡∏•‡∏≤/‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á/‡∏ú‡∏π‡πâ‡πÄ‡∏™‡∏ô‡∏≠ ‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö");
          return;
        }

        try {
          const refno = await generateRefNo();
          await addDoc(docsCol, {
            refno, date, time, subject, urgency, secret, from, note,
            status: "‡∏£‡∏≠‡πÄ‡∏™‡∏ô‡∏≠",
            createdAt: serverTimestamp(),
          });

          // reset form
          document.getElementById("date").value = "";
          document.getElementById("time").value = "";
          document.getElementById("subject").value = "";
          document.getElementById("urgency").value = "‡∏õ‡∏Å‡∏ï‡∏¥";
          document.getElementById("secret").value  = "‡∏•‡∏±‡∏ö";
          document.getElementById("from").value = "";
          document.getElementById("note").value = "";

          alert("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‚úÖ");
          updateDashboard();
        } catch (e) {
          console.error(e);
          alert("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡πÇ‡∏õ‡∏£‡∏î‡∏•‡∏≠‡∏á‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á");
        }
      });

      /* 8) ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ + Render + ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ + ‡∏Å‡∏£‡∏≠‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ */
      let cacheDocs = []; // { id, data, createdText }

      function renderTable() {
        const kw = (searchBox.value || "").trim().toLowerCase();
        const filtered = cacheDocs
          .filter(({ data }) => currentFilter === "‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î" || data.status === currentFilter)
          .filter(({ data }) => {
            if (!kw) return true;
            const refno   = (data.refno   || "").toLowerCase();
            const subject = (data.subject || "").toLowerCase();
            const from    = (data.from    || "").toLowerCase();
            return refno.includes(kw) || subject.includes(kw) || from.includes(kw);
          });

        tbody.innerHTML = "";
        filtered.forEach(({ id, data, createdText }) => {
          const tr = document.createElement("tr");
          tr.innerHTML = `
            <td>${data.refno || "-"}</td>
            <td>${data.date || "-"}</td>
            <td>${data.time || "-"}</td>
            <td>${data.subject || "-"}</td>
            <td>${data.urgency || "-"}</td>
            <td>${data.secret || "-"}</td>
            <td>${data.from || "-"}</td>
            <td>${data.note || "-"}</td>
            <td>${statusIcon(data.status)} ${data.status || "-"}</td>
            <td>
              <button onclick="updateStatus('${id}','‡∏£‡∏≠‡πÄ‡∏ã‡πá‡∏ô')">‡∏£‡∏≠‡πÄ‡∏ã‡πá‡∏ô</button>
              <button onclick="updateStatus('${id}','‡πÄ‡∏ã‡πá‡∏ô‡πÅ‡∏•‡πâ‡∏ß')">‡πÄ‡∏ã‡πá‡∏ô‡πÅ‡∏•‡πâ‡∏ß</button>
              <button onclick="updateStatus('${id}','‡∏™‡πà‡∏á‡∏Ñ‡∏∑‡∏ô‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç')">‡∏™‡πà‡∏á‡∏Ñ‡∏∑‡∏ô‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
            </td>
            <td>${createdText}</td>
          `;
          tbody.appendChild(tr);
        });
      }

      // ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ Filter buttons (‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏Å‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏°‡πÉ‡∏ô Part 1)
      let currentFilter = "‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î";
      document.getElementById("filterAll").onclick     = () => { currentFilter = "‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î"; renderTable(); };
      document.getElementById("filterWait").onclick     = () => { currentFilter = "‡∏£‡∏≠‡πÄ‡∏™‡∏ô‡∏≠"; renderTable(); };
      document.getElementById("filterPending").onclick  = () => { currentFilter = "‡∏£‡∏≠‡πÄ‡∏ã‡πá‡∏ô"; renderTable(); };
      document.getElementById("filterSigned").onclick   = () => { currentFilter = "‡πÄ‡∏ã‡πá‡∏ô‡πÅ‡∏•‡πâ‡∏ß"; renderTable(); };
      document.getElementById("filterReturn").onclick   = () => { currentFilter = "‡∏™‡πà‡∏á‡∏Ñ‡∏∑‡∏ô‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç"; renderTable(); };

      // ‡∏ä‡πà‡∏≠‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
      searchBox.addEventListener("input", renderTable);

      // ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ realtime
      const qList = query(docsCol, orderBy("createdAt", "desc"));
      onSnapshot(qList, (snap) => {
        cacheDocs = [];
        snap.forEach((ds) => {
          const d = ds.data();
          const created = d.createdAt?.toDate?.() ? d.createdAt.toDate() : null;
          cacheDocs.push({
            id: ds.id,
            data: d,
            createdText: created ? fmtDateTimeTH(created) : "-",
          });
        });
        renderTable();
      });

      /* 9) ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ (‡πÉ‡∏´‡πâ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ) */
      async function _updateStatus(id, newStatus) {
        try {
          await updateDoc(doc(db, "incoming_docs", id), { status: newStatus });
          updateDashboard();
        } catch (e) {
          console.error(e);
          alert("‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à");
        }
      }
      window.updateStatus = _updateStatus;

      /* 10) Export Excel */
      exportBtn.addEventListener("click", async () => {
        try {
          const snap = await getDocs(qList);
          const rows = [];
          snap.forEach((ds) => {
            const d = ds.data();
            const created = d.createdAt?.toDate?.()
              ? fmtDateTimeTH(d.createdAt.toDate()) : "-";
            rows.push({
              ‡πÄ‡∏•‡∏Ç‡∏£‡∏±‡∏ö: d.refno || "-",
              ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö: d.date || "-",
              ‡πÄ‡∏ß‡∏•‡∏≤: d.time || "-",
              ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á: d.subject || "-",
              ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡πà‡∏ß‡∏ô: d.urgency || "-",
              ‡∏ä‡∏±‡πâ‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏±‡∏ö: d.secret || "-",
              ‡∏ú‡∏π‡πâ‡πÄ‡∏™‡∏ô‡∏≠: d.from || "-",
              ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: d.note || "-",
              ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: d.status || "-",
              ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏°‡∏∑‡πà‡∏≠: created,
            });
          });
          const ws = XLSX.utils.json_to_sheet(rows);
          const wb = XLSX.utils.book_new();
          XLSX.utils.book_append_sheet(wb, ws, "Docs");
          const filename = `incoming-docs-${new Date().toISOString().slice(0,10)}.xlsx`;
          XLSX.writeFile(wb, filename);
          alert("‚úÖ ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå Excel ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à");
        } catch (e) {
          console.error(e);
          alert("‚ùå Export ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß");
        }
      });

      /* 11) Dashboard (‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô/‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô) */
      async function updateDashboard() {
        const now = new Date();
        const y = now.getFullYear(), m = now.getMonth();
        const startDay   = new Date(y, m, now.getDate(), 0, 0, 0);
        const startMonth = new Date(y, m, 1, 0, 0, 0);

        const qDay   = query(docsCol, where("createdAt", ">=", Timestamp.fromDate(startDay)));
        const qMonth = query(docsCol, where("createdAt", ">=", Timestamp.fromDate(startMonth)));

        const daySnap   = await getDocs(qDay);
        const monthSnap = await getDocs(qMonth);

        dailyEl.textContent   = `‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô: ${daySnap.size} ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á`;
        monthlyEl.textContent = `‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô: ${monthSnap.size} ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á`;
      }
      setInterval(updateDashboard, 5000);
      updateDashboard();
    </script>
  </main>
</body>
</html>
